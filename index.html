<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ULTIMATE Volume & Trending Engine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
</head>
<body class="bg-slate-950 text-slate-200 p-4 font-mono text-[13px]">
    <div class="max-w-6xl mx-auto space-y-4">
        
        <div class="bg-gradient-to-r from-indigo-900 via-slate-900 to-indigo-900 p-4 rounded-2xl flex justify-between items-center border border-indigo-500/30 shadow-2xl">
            <div>
                <h1 class="text-2xl font-black text-white tracking-tighter italic">GEMINI TRENDING ENGINE <span class="text-indigo-400 text-xs not-italic font-bold ml-2">v5.0 PRO</span></h1>
                <p class="text-[10px] text-indigo-300 font-bold uppercase tracking-[0.2em]">High-Frequency Volume & Organic Growth Simulation</p>
            </div>
            <div id="statusHeader" class="text-right">
                <div id="connectionStatus" class="text-xs font-black text-red-500">RPC DISCONNECTED</div>
                <div id="mainBalance" class="text-lg font-black text-green-400">0.00 SOL</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-4">
            
            <div class="bg-slate-900 border border-slate-800 p-5 rounded-2xl space-y-4 shadow-xl">
                <h2 class="text-indigo-400 font-black border-b border-slate-800 pb-2 flex justify-between">
                    <span>CORE CONFIG</span>
                    <span class="text-[10px] text-slate-500">STEP 1</span>
                </h2>
                
                <div class="space-y-3">
                    <div>
                        <label class="block text-[10px] text-slate-500 font-bold mb-1">TOKEN MINT (CA)</label>
                        <input id="mint" type="text" placeholder="Pump.fun Address" class="w-full bg-black p-2 rounded border border-slate-700 text-blue-400 focus:border-indigo-500 outline-none">
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        <div>
                            <label class="block text-[10px] text-slate-500 font-bold mb-1">WALLETS</label>
                            <input id="numWallets" type="number" value="5" class="w-full bg-black p-2 rounded border border-slate-700">
                        </div>
                        <div>
                            <label class="block text-[10px] text-slate-500 font-bold mb-1">FUND (SOL)</label>
                            <input id="fundAmount" type="number" value="0.08" class="w-full bg-black p-2 rounded border border-slate-700">
                        </div>
                    </div>
                    <button onclick="distributeSOL()" id="fundBtn" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-black py-3 rounded-xl transition-all shadow-lg active:scale-95">
                        INITIALIZE WALLETS
                    </button>
                </div>
            </div>

            <div class="bg-slate-900 border border-slate-800 p-5 rounded-2xl space-y-4 shadow-xl">
                <h2 class="text-emerald-400 font-black border-b border-slate-800 pb-2 flex justify-between">
                    <span>TRADE STRATEGY</span>
                    <span class="text-[10px] text-slate-500">STEP 2</span>
                </h2>
                
                <div class="space-y-3">
                    <div class="grid grid-cols-2 gap-2">
                        <div>
                            <label class="block text-[10px] text-slate-500 font-bold mb-1">MIN BUY</label>
                            <input id="minBuy" type="number" value="0.01" class="w-full bg-black p-2 rounded border border-slate-700">
                        </div>
                        <div>
                            <label class="block text-[10px] text-slate-500 font-bold mb-1">MAX BUY</label>
                            <input id="maxBuy" type="number" value="0.04" class="w-full bg-black p-2 rounded border border-slate-700">
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        <div>
                            <label class="block text-[10px] text-slate-500 font-bold mb-1">INTERVAL (S)</label>
                            <input id="interval" type="number" value="10" class="w-full bg-black p-2 rounded border border-slate-700">
                        </div>
                        <div>
                            <label class="block text-[10px] text-slate-500 font-bold mb-1">JITTER %</label>
                            <input id="jitter" type="number" value="30" class="w-full bg-black p-2 rounded border border-slate-700">
                        </div>
                    </div>
                    <div class="bg-black/40 p-3 rounded-lg border border-slate-800">
                        <label class="flex items-center space-x-2 cursor-pointer">
                            <input id="autoSell" type="checkbox" checked class="accent-emerald-500">
                            <span class="text-[10px] font-bold text-slate-300">AUTO-SELL AFTER BUYS</span>
                        </label>
                        <div class="mt-2 grid grid-cols-2 gap-2">
                            <input id="sellDelay" type="number" value="2" placeholder="After X buys" class="bg-black text-[10px] p-1 border border-slate-700 rounded w-full">
                            <input id="sellPercent" type="number" value="95" placeholder="Sell %" class="bg-black text-[10px] p-1 border border-slate-700 rounded w-full">
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-slate-900 border border-slate-800 p-5 rounded-2xl space-y-4 shadow-xl">
                <h2 class="text-orange-400 font-black border-b border-slate-800 pb-2 flex justify-between">
                    <span>NETWORK PRO</span>
                    <span class="text-[10px] text-slate-500">STEP 3</span>
                </h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-[10px] text-slate-500 font-bold mb-1">PRIORITY FEE (SOL)</label>
                        <input id="priorityFee" type="number" value="0.002" class="w-full bg-black p-2 rounded border border-slate-700">
                    </div>
                    <div>
                        <label class="block text-[10px] text-slate-500 font-bold mb-1">SLIPPAGE %</label>
                        <input id="slippage" type="number" value="20" class="w-full bg-black p-2 rounded border border-slate-700">
                    </div>
                    <div class="p-3 bg-orange-950/20 border border-orange-500/30 rounded-lg">
                        <p class="text-[9px] text-orange-300 font-bold">ANTI-MEV PROTECTION ACTIVE</p>
                        <p class="text-[8px] text-slate-500 mt-1">Using Local Signing to bypass sandwich bots.</p>
                    </div>
                    <button onclick="toggleEngine()" id="startBtn" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-black py-4 rounded-xl text-sm uppercase tracking-widest transition-all shadow-[0_0_20px_rgba(16,185,129,0.3)]">
                        START ENGINE
                    </button>
                </div>
            </div>

            <div class="lg:col-span-1 bg-black rounded-2xl border border-slate-800 flex flex-col h-[520px] overflow-hidden">
                <div class="p-3 border-b border-slate-800 bg-slate-900/40 flex justify-between items-center">
                    <span class="text-[10px] font-black text-slate-500 uppercase">Activity Log</span>
                    <button onclick="downloadBackup()" class="text-[9px] bg-slate-800 px-2 py-1 rounded text-slate-300 hover:bg-slate-700">BACKUP KEYS</button>
                </div>
                <div id="logBox" class="p-4 overflow-y-auto text-[10px] flex-grow space-y-2 font-mono scrollbar-hide">
                    <div class="text-indigo-500">Initializing Engine v5.0... Ready for deployment.</div>
                </div>
                <div id="subWalletStatus" class="p-2 bg-slate-900/80 border-t border-slate-800 text-[9px] max-h-32 overflow-y-auto">
                    <div class="text-slate-500 uppercase font-black mb-1">Sub-Wallet Balances</div>
                    </div>
            </div>
        </div>
    </div>

    <script>
        // --- SECURE DATA ---
        const USER = {
            PK: "jqoRrkLVfQASVSFBQCo5S3V1K1EK64K8BB9esg3vhP42EwSXSD4ymgorrYEbY2DrvJkWA7NiYua17rd6yAnDewf",
            RPC: "https://mainnet.helius-rpc.com/?api-key=8fb904ee-3236-4d78-ba87-91da6ea352d6",
            API: "a597mwuq610mgkbj8d36jm9hd5v6ydu26dtq6p3rcda4eua2dh37mwbfadvq4j2jdnnpwm2hf554rrju71m58w23dnvk0ujrcdqp4jja693pmw2m8rt68hkre1a7jnbkf9770n35ewyku698mggjkedm6rjkbed7k4u9h8meh23jxthadp38n9meda54w3tawqmmuvkdx8kuf8"
        };

        // --- INTERNAL UTILS ---
        const b58_A = "123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";
        function b58D(s) {
            let b = [0];
            for (let i=0; i<s.length; i++) {
                let c = b58_A.indexOf(s[i]);
                for (let j=0; j<b.length; j++) b[j] *= 58;
                b[0] += c;
                let carry = 0;
                for (let j=0; j<b.length; j++) {
                    b[j] += carry; carry = b[j] >> 8; b[j] &= 0xff;
                }
                while (carry) { b.push(carry & 0xff); carry >>= 8; }
            }
            for (let i=0; i<s.length && s[i]==='1'; i++) b.push(0);
            return new Uint8Array(b.reverse());
        }

        // --- STATE ---
        const connection = new solanaWeb3.Connection(USER.RPC, 'confirmed');
        let mainWallet, subWallets = [], isRunning = false;
        let buyCounts = {}; // Track buys per wallet for auto-sell

        function log(m, type="info") {
            const b = document.getElementById('logBox');
            const d = document.createElement('div');
            const colors = { info: 'text-slate-500', success: 'text-emerald-400', warn: 'text-orange-400', error: 'text-red-500 font-bold' };
            d.className = colors[type];
            d.innerHTML = `<span class="opacity-30">[${new Date().toLocaleTimeString()}]</span> ${m}`;
            b.prepend(d);
        }

        async function updateStatus() {
            try {
                const bal = await connection.getBalance(mainWallet.publicKey);
                document.getElementById('mainBalance').innerText = `${(bal/1e9).toFixed(3)} SOL`;
                document.getElementById('connectionStatus').innerText = "RPC ACTIVE";
                document.getElementById('connectionStatus').className = "text-xs font-black text-emerald-500";
                
                const swBox = document.getElementById('subWalletStatus');
                let html = '<div class="text-slate-500 uppercase font-black mb-1">Sub-Wallet Balances</div>';
                for(let sw of subWallets) {
                    const sb = await connection.getBalance(sw.publicKey);
                    html += `<div class="flex justify-between"><span>${sw.publicKey.toBase58().slice(0,6)}...</span><span class="text-emerald-500">${(sb/1e9).toFixed(3)}</span></div>`;
                }
                swBox.innerHTML = html;
            } catch(e) {}
        }

        async function init() {
            mainWallet = solanaWeb3.Keypair.fromSecretKey(b58D(USER.PK));
            updateStatus();
            setInterval(updateStatus, 15000);
            log("Engine Hardware Ready.", "info");
        }
        window.onload = init;

        // --- CORE ACTIONS ---
        async function distributeSOL() {
            const count = parseInt(document.getElementById('numWallets').value);
            const amount = parseFloat(document.getElementById('fundAmount').value);
            const btn = document.getElementById('fundBtn');
            
            btn.disabled = true;
            btn.innerText = "FUNDING...";
            log(`Initializing ${count} Worker Wallets...`, "warn");

            subWallets = [];
            const tx = new solanaWeb3.Transaction();
            for(let i=0; i<count; i++) {
                const sw = solanaWeb3.Keypair.generate();
                subWallets.push(sw);
                buyCounts[sw.publicKey.toBase58()] = 0;
                tx.add(solanaWeb3.SystemProgram.transfer({
                    fromPubkey: mainWallet.publicKey,
                    toPubkey: sw.publicKey,
                    lamports: Math.floor(amount * solanaWeb3.LAMPORTS_PER_SOL)
                }));
            }

            try {
                const sig = await solanaWeb3.sendAndConfirmTransaction(connection, tx, [mainWallet]);
                log(`Wallets Activated! TX: ${sig.slice(0,8)}`, "success");
                btn.innerText = "WALLETS READY";
                btn.className = "w-full bg-emerald-700 text-white font-black py-3 rounded-xl";
            } catch(e) { log("Funding Error: Check Main Balance", "error"); btn.disabled = false; }
        }

        async function toggleEngine() {
            if(!subWallets.length) return alert("Fund Wallets First!");
            isRunning = !isRunning;
            const btn = document.getElementById('startBtn');
            
            if(isRunning) {
                btn.innerText = "STOP ENGINE";
                btn.classList.replace('bg-emerald-600', 'bg-red-600');
                log("--- VOLUME ENGINE ONLINE ---", "success");
                runLoop();
            } else {
                btn.innerText = "START ENGINE";
                btn.classList.replace('bg-red-600', 'bg-emerald-600');
                log("--- ENGINE OFFLINE ---", "warn");
            }
        }

        async function runLoop() {
            const mint = document.getElementById('mint').value;
            const interval = parseInt(document.getElementById('interval').value) * 1000;
            const jitter = parseInt(document.getElementById('jitter').value) / 100;

            while(isRunning) {
                const sw = subWallets[Math.floor(Math.random() * subWallets.length)];
                const pub = sw.publicKey.toBase58();
                
                // Logic: Decide Buy or Sell
                if(document.getElementById('autoSell').checked && buyCounts[pub] >= parseInt(document.getElementById('sellDelay').value)) {
                    await trade(sw, mint, "sell", document.getElementById('sellPercent').value + "%");
                    buyCounts[pub] = 0;
                } else {
                    const min = parseFloat(document.getElementById('minBuy').value);
                    const max = parseFloat(document.getElementById('maxBuy').value);
                    const amount = (Math.random() * (max - min) + min).toFixed(3);
                    await trade(sw, mint, "buy", amount);
                    buyCounts[pub]++;
                }

                const wait = interval * (1 + (Math.random() * jitter * 2 - jitter));
                await new Promise(r => setTimeout(r, wait));
            }
        }

        async function trade(wallet, mint, action, amount) {
            try {
                const res = await fetch('https://pumpportal.fun/api/trade-local', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        "publicKey": wallet.publicKey.toBase58(),
                        "action": action,
                        "mint": mint,
                        "amount": amount,
                        "denominatedInSol": action === "buy" ? "true" : "false",
                        "slippage": parseInt(document.getElementById('slippage').value),
                        "priorityFee": parseFloat(document.getElementById('priorityFee').value),
                        "pool": "pump"
                    })
                });

                if(res.ok) {
                    const data = await res.arrayBuffer();
                    const tx = solanaWeb3.VersionedTransaction.deserialize(new Uint8Array(data));
                    tx.sign([wallet]);
                    const sig = await connection.sendRawTransaction(tx.serialize());
                    log(`${action.toUpperCase()} ${amount} | Wallet: ..${wallet.publicKey.toBase58().slice(-4)}`, action === "buy" ? "success" : "warn");
                }
            } catch(e) { log(`${action} Failed`, "error"); }
        }

        function downloadBackup() {
            const data = subWallets.map(w => ({ address: w.publicKey.toBase58(), key: Array.from(w.secretKey) }));
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `Gemini_Engine_Keys.json`;
            a.click();
        }
    </script>
</body>
</html>
